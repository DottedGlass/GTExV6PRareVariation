# Input  files
TSS_list = list of TSS
oneKKG_vcf = vcf of 1000 genomes on african samples
gtex_vcf = vcf of gtex v8 (african individuals only)
multi_tissue_outliers = ${RAREVARDIR}/data/v8/outliers_medz_picked.txt

# subset both vcf for variants within 10kb of genes in TSS_list
subtract 10kb from start column of TSS_list. Call this TSS_list_10kb
use bedtools to get intersection of TSS_list_10kb with both vcf files. Output is vcf file

# compute allele frequencies
use vcftools to compute frequencies (SNVs only) on both vcfs

# find rare variants based on frequency <0.01 in both 1KG and GTEx
loop through each variant in GTEx
  if variant in GTEx is <0.01
    if variant exists in 1KG
      if variant frequency in both is <0.01
        write this variant to rare_variant_list
    else
        write this variant to rare_variant_list

# build the output file
loop through all genes with at least 1 outlier individual (multi_tissue_outliers)
  identify rows on gtex_vcf (variants within 10kb of the gene)
  loop on all african individuals
    if variants are in the rare_variant_list
      add variant to col3 of output file
      $chrom:$position:$major_allele:$variant_allele

# build output file (vectorized)
find all genes with at least 1 outlier individual
filter TSS_list_10kb for genes with at least 1 outlier individual
filter rare_variant_list for variants that are within a 10kb TSS window of outlier gene
for each rare variant, find individuals that have the rare variant




#output file format
#Col1: Gene
#Col2: Indiv
#Col3: Comma separated list of variants


## count number of variants by african individual in gtex
gtex_vcf = african individuals, SNP only, --max-missing-count 10
gtex_vcf.frq = frequency file
1KG_vcf.frq = frequency file from 1KG vcf with african individuals only, SNP only, --max-missing-count 10


```
bcftools view --output-file GTEx_v8_WGS_ARA.recode_SNP.vcf.gz --output-type z --types snps GTEx_v8_WGS_ARA.recode.vcf.gz
```

get gtex_vcf with african indivuals, SNP only, --max-mssing-count 10
create frequency file from gtex_vcf
use filter_for_rare_variants.py on gtex_vcf.frq and 1KG_vcf.frq to get gtex_vcf_rare.frq
use awk to split gtex_vcf_rare.frq into two frq files
  out_file_1 has the reference allele (column 5) as the minor allele
  out_file_2 has the alternate allele (column 6) as the minor allele
```
tail -n +2 ${infile} | awk 'BEGIN {OFS="\t"} {split($NF,last,":");  if((last[2] < 0.5)) {print $1,$2-1,$2}}' > out_file1.bed
tail -n +2 ${infile} | awk 'BEGIN {OFS="\t"} {split($NF,last,":");  if((last[2] > 0.5)) {print $1,$2-1,$2}}' > out_file2.bed
```

subset gtex_vcf with bcftools
```
bcftools --output-file gtex_vcf_1.vcf.gz --output-type z --regions-file out_file1.bed --no-header gtex_vcf
bcftools --output-file gtex_vcf_2.vcf.gz --output-type z --regions-file out_file2.bed --no-header gtex_vcf
```


case 1: using out_file_1 and gtex_vcf
  subset gtex_vcf by variant locations (CHROM and POS) in out_file_1
  count the number of times that 0's that show up in columns of the individual in gtex_vcf

case 2: using out_file_2 and gtex_vcf
  subset gtex_vcf by variant locations (CHROM and POS) in out_file_2
  count the number of times that 1's that show up in columns of the individual in gtex_vcf

add the counts for each columns of the individual
